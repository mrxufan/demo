{"remainingRequest":"G:\\dingCanMobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\dingCanMobile\\src\\views\\pay.vue?vue&type=style&index=0&id=e4524d7e&scoped=scoped&lang=css&","dependencies":[{"path":"G:\\dingCanMobile\\src\\views\\pay.vue","mtime":1591671721793},{"path":"G:\\dingCanMobile\\node_modules\\css-loader\\dist\\cjs.js","mtime":1587344362830},{"path":"G:\\dingCanMobile\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1587344055013},{"path":"G:\\dingCanMobile\\node_modules\\postcss-loader\\src\\index.js","mtime":1587344830790},{"path":"G:\\dingCanMobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1587344699430},{"path":"G:\\dingCanMobile\\node_modules\\vue-loader\\lib\\index.js","mtime":1587344054728}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KCQ0KLm9wZW4tZGVmYXVsdC1icm93c2Vye3Bvc2l0aW9uOiBmaXhlZDt3aWR0aDogMTAwJTtoZWlnaHQ6IDEwMCU7YmFja2dyb3VuZDogcmdiYSgwLDAsMCwuOCk7bGVmdDogMDt0b3A6IDA7ei1pbmRleDogOTk5OTk5OTk7fQ0KLm9wZW4tZGVmYXVsdC1icm93c2VyIC5pbWd7d2lkdGg6IDgwJTtwb3NpdGlvbjogYWJzb2x1dGU7bGVmdDogNTclO3RyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsLTUwJSk7dG9wOiAyNSU7fQ0KLm9wZW4tZGVmYXVsdC1icm93c2VyIGltZ3t3aWR0aDogMTAwJTt9DQo="},{"version":3,"sources":["pay.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6FA;AACA;AACA","file":"pay.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n\t<!-- 在默认浏览器打开背景层 -->\r\n\t<div v-show=\"payLayer\" class=\"open-default-browser\">\r\n\t\t<div class=\"img\">\r\n\t\t\t<img src=\"../assets/login/default_browser.png\" alt=\"\">\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script type=\"text/javascript\">\r\n\t\r\n\texport default {\r\n\t\tdata: function() {\r\n\t\t\treturn {\r\n\t\t\t\tpayLayer:true,\r\n\t\t\t};\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\r\n\t\t},\r\n\t\tcreated: function() {\r\n\t\t\t var _this=this;\r\n\t\t\t  var ua = navigator.userAgent.toLowerCase();\r\n\t\t\t  if(ua.match(/MicroMessenger/i)==\"micromessenger\"){\r\n\t\t  \r\n\t\t\t  }else{\r\n\t\t\t\t _this.payLayer=false;//关闭蒙层\r\n\t\t\t\t_this.$axios({\r\n\t\t\t\t  method: 'get',\r\n\t\t\t\t  url:'http://www.zzboyaxun.com:10002/v1/payRecord/createH5Wechat',\r\n\t\t\t\t  // headers:{'token':sessionStorage.getItem('token')},\r\n\t\t\t\t  params: {\r\n\t\t\t\t\ttotalFee:1,//分\r\n\t\t\t\t\tbody:'描述'\r\n\t\t\t\t  }\r\n\t\t\t\t}).then(function(data){\r\n\t\t\t\t\t// sellerOrderNo:data.data.data.outTradeNo//商家订单号\r\n\t\t\t\t\t// window.location.href=data.data.data.payUrl+'&redirect_url=http://www.baidu.com'\r\n\t\t\t\t\twindow.open(data.data.payUrl);\r\n\t\t\t\t\t var websocket = null;\r\n\t\t\t\t\t    //判断当前浏览器是否支持WebSocket\r\n\t\t\t\t\t    if ('WebSocket' in window) {\r\n\t\t\t\t\t        websocket = new WebSocket(\"ws://www.zzboyaxun.com:10002/byxsrb/\"+data.data.data.outTradeNo);\r\n\t\t\t\t\t    }\r\n\t\t\t\t\t    else {\r\n\t\t\t\t\t\t\t_this.$toast('不支持该操作')\r\n\t\t\t\t\t    }\r\n\t\t\t\t\t\r\n\t\t\t\t\t    //连接发生错误的回调方法\r\n\t\t\t\t\t    websocket.onerror = function () {\r\n\t\t\t\t\t        \r\n\t\t\t\t\t    };\r\n\t\t\t\t\t\r\n\t\t\t\t\t    //连接成功建立的回调方法\r\n\t\t\t\t\t    websocket.onopen = function () {\r\n\t\t\t\t\t        \r\n\t\t\t\t\t    }\r\n\t\t\t\t\t\r\n\t\t\t\t\t    //接收到消息的回调方法\r\n\t\t\t\t\t    websocket.onmessage = function (event) {\r\n\t\t\t\t\t\t\talert(event.data)\r\n\t\t\t\t\t\t\t_this.$router.push({path:'orderList'})\r\n\t\t\t\t\t    }\r\n\t\t\t\t\t\r\n\t\t\t\t\t    //连接关闭的回调方法\r\n\t\t\t\t\t    websocket.onclose = function () {\r\n\t\t\t\t\t        alert('连接关闭');\r\n\t\t\t\t\t\t\twebsocket = new WebSocket(\"ws://www.zzboyaxun.com:10002/byxsrb/\"+data.data.data.outTradeNo);\r\n\t\t\t\t\t    }\r\n\t\t\t\t\t\r\n\t\t\t\t\t    //监听窗口关闭事件，当窗口关闭时，主动去关闭websocket连接，防止连接还没断开就关闭窗口，server端会抛异常。\r\n\t\t\t\t\t    window.onbeforeunload = function () {\r\n\t\t\t\t\t        closeWebSocket();\r\n\t\t\t\t\t    }\r\n\t\t\t\t\t\r\n\t\t\t\t\t    //关闭WebSocket连接\r\n\t\t\t\t\t    function closeWebSocket() {\r\n\t\t\t\t\t        websocket.close();\r\n\t\t\t\t\t    }\r\n\t\t\t\t\t  \r\n\t\t\t\t\t\r\n\t\t\t\t}).catch(function(error){\r\n\t\t\t\t\tconsole.log(error);\r\n\t\t\t\t});\r\n\t\t\t  }\r\n\t\t\t}\r\n\t};\r\n</script>\r\n<style scoped=\"scoped\" type=\"text/css\">\r\n\t\r\n.open-default-browser{position: fixed;width: 100%;height: 100%;background: rgba(0,0,0,.8);left: 0;top: 0;z-index: 99999999;}\r\n.open-default-browser .img{width: 80%;position: absolute;left: 57%;transform: translate(-50%,-50%);top: 25%;}\r\n.open-default-browser img{width: 100%;}\r\n</style>\r\n"]}]}