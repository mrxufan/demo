{"remainingRequest":"G:\\dingCanMobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\dingCanMobile\\src\\views\\winList.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"G:\\dingCanMobile\\src\\views\\winList.vue","mtime":1593328565590},{"path":"G:\\dingCanMobile\\node_modules\\css-loader\\dist\\cjs.js","mtime":1587344362830},{"path":"G:\\dingCanMobile\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1587344055013},{"path":"G:\\dingCanMobile\\node_modules\\postcss-loader\\src\\index.js","mtime":1587344830790},{"path":"G:\\dingCanMobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1587344699430},{"path":"G:\\dingCanMobile\\node_modules\\vue-loader\\lib\\index.js","mtime":1587344054728}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQoud2luLWxpc3QgbGl7cG9zaXRpb246IHJlbGF0aXZlO2JhY2tncm91bmQ6ICNmZmY7cGFkZGluZzogMTBweDtvdmVyZmxvdzogaGlkZGVuO21hcmdpbjogMTBweDtwYWRkaW5nLXJpZ2h0OiA1MHB4O30NCi53aW4tbGlzdCBsaSAud2luLXN0YXR1c3twb3NpdGlvbjogYWJzb2x1dGU7d2lkdGg6IDUwcHg7aGVpZ2h0OiA1MHB4O3JpZ2h0OiAwO3RvcDogMDt9DQoud2luLWxpc3QgbGkgLndpbi1pbWd7d2lkdGg6IDc1cHg7aGVpZ2h0OiA3NXB4O2JhY2tncm91bmQ6ICNlZWU7ZmxvYXQ6IGxlZnQ7bWFyZ2luLXJpZ2h0OiAxMHB4O30NCi53aW4tbGlzdCBsaSAud2luLWltZyBpbWd7d2lkdGg6IDc1cHg7aGVpZ2h0OiA3NXB4O30NCi53aW4tbGlzdCAud2luLW5hbWV7Zm9udC1zaXplOiAxNnB4O292ZXJmbG93OiBoaWRkZW47d2hpdGUtc3BhY2U6IG5vd3JhcDt0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcztoZWlnaHQ6IDIwcHg7bGluZS1oZWlnaHQ6IDIwcHg7fQ0KLndpbi1saXN0IC5zZWxsLW51bXtmb250LXNpemU6IDEycHg7Y29sb3I6ICM5OTk7bWFyZ2luOiA1cHggMDt9DQoud2luLWxpc3QgLnNlbGwtbnVtIHNwYW57bWFyZ2luLWxlZnQ6IDRweDt9DQoud2luLWxpc3QgLnNlbGwtbnVtLC53aW4tbGlzdCAucHJpY2V7Zm9udC1zaXplOiAxMnB4O2NvbG9yOiAjOTk5O30NCi53aW4tbGlzdCAud2luLXR5cGV7Zm9udC1zaXplOiAxMnB4O3Bvc2l0aW9uOiBhYnNvbHV0ZTtib3R0b206IDEycHg7cmlnaHQ6IDA7fQ0KLndpbi1saXN0IC53aW4tdHlwZSBzcGFue3BhZGRpbmc6IDAgNHB4O21hcmdpbi1yaWdodDogMnB4O30NCi53aW4tbGlzdCAud2luLXR5cGUgc3Bhbi56dHtiYWNrZ3JvdW5kOiAjRkZGNUU4O2NvbG9yOiAjRUNCMDYxO30NCi53aW4tbGlzdCAud2luLXR5cGUgc3Bhbi53c3tiYWNrZ3JvdW5kOiAjRjJGRkU4O2NvbG9yOiAjODZDNjY5O30NCi53aW4tbGlzdCAud2luLXR5cGUgc3Bhbi5kZHtiYWNrZ3JvdW5kOiAjRThGNEZGO2NvbG9yOiAjNjlBMUM2O30NCg=="},{"version":3,"sources":["winList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"winList.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n\t<div class=\"win-list\">\r\n\t\t\r\n\t\t<!-- 顶部导航 -->\r\n\t\t<top-fixed-nav :title=\"shopName\"></top-fixed-nav>\r\n\t\t<van-pull-refresh v-model=\"isLoading\" @refresh=\"onRefresh\">\r\n\t\t\t<!-- 窗口列表 -->\r\n\t\t\t<div class=\"win-list\" style=\"min-height: 300px;\">\r\n\t\t\t\t<ul>\r\n\t\t\t\t\t<li v-for=\"item in winList\" @click=\"toWinDetail(item.winName,item.winId,item.sellerId,item.deliveryMinAmount,item.deliveryFee,item.deliveryMode,item.businessState,item.orderCount,item.commentScore)\">\r\n\t\t\t\t\t\t<img :src=\"item.winState\" class=\"win-status\">\r\n\t\t\t\t\t\t<div class=\"win-img\"><img :src=\"item.windowPic\"></div>\r\n\t\t\t\t\t\t<div class=\"win-info\">\r\n\t\t\t\t\t\t\t<p class=\"win-name\">{{item.winName}}</p>\r\n\t\t\t\t\t\t\t<p class=\"sell-num\"><van-rate v-model=\"item.commentScore\" color=\"#F4BE42\" readonly count=\"5\" /><span>月售{{item.orderCount}}单</span></p>\r\n\t\t\t\t\t\t\t<p class=\"price\">\r\n\t\t\t\t\t\t\t\t<span v-show=\"item.deliveryMinAmount\" style=\"margin-right: 5px;\">起送￥{{item.deliveryMinAmount}}</span>\r\n\t\t\t\t\t\t\t\t<span>配送￥{{item.deliveryFee?item.deliveryFee:0}}</span>\r\n\t\t\t\t\t\t\t</p>\r\n\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<p class=\"win-type\">\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<span v-bind:class=\"[item1=='1'?'ws':item1=='2'?'zt':'dd']\" v-for=\"item1 in item.deliveryMode\">{{item1=='1'?'外送':item1=='2'?'自提':'到店用餐'}}</span>\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\t\t</van-pull-refresh>\r\n\t\t\r\n\t</div>\r\n</template>\r\n\r\n<script type=\"text/javascript\">\r\n\tvar pageNum=1;//页码\r\n\texport default{\r\n\t\tdata:function(){\r\n\t\t\treturn{\r\n\t\t\t\tsellerId:'',//商家id\r\n\t\t\t\tshopName:'',//标题\r\n\t\t\t\tshopId:this.$route.query.shopId,//店铺传递的店铺id\r\n\t\t\t\tshopName:this.$route.query.shopName,//店铺传递的店铺名称\r\n\t\t\t\twinList:[],//窗口列表\r\n\t\t\t\tstar:3,//评分\r\n\t\t\t\t// winStatus:'./static/images/icon/yuding_icon.png',//图片\r\n\t\t\t\tsellerState:[],//商家状态\r\n\t\t\t\tisLoading:false,//上拉刷新\r\n\t\t\t};\r\n\t\t},\r\n\t\tcomponents:{\r\n\t\t\t\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\t // 滚动到底加载更多\r\n\t\t\twindow.addEventListener('scroll',this.reachBottom)\t\t\t  \r\n\t\t},\r\n\t\t// 销毁监听滚动条事件\r\n\t\tdestroyed(){\r\n\t\t    window.removeEventListener('scroll', this.reachBottom)\r\n\t\t\tconsole.log('销毁')\r\n\t\t  },\r\n\t\tmethods:{\r\n\t\t\t// 滚动到底加载更多\r\n\t\t\treachBottom(){\r\n\t\t\t\t  //变量scrollTop是滚动条滚动时，距离顶部的距离\r\n\t\t\t\t  let scrollTop = document.documentElement.scrollTop||document.body.scrollTop;\r\n\t\t\t\t  //变量windowHeight是可视区的高度\r\n\t\t\t\t  let windowHeight = document.documentElement.clientHeight || document.body.clientHeight;\r\n\t\t\t\t  //变量scrollHeight是滚动条的总高度\r\n\t\t\t\t  let scrollHeight = document.documentElement.scrollHeight||document.body.scrollHeight;\r\n\t\t\t\t\t//滚动条到底部的条件\r\n\t\t\t\t\tif(scrollTop+windowHeight >= scrollHeight){\r\n\t\t\t\t\t\tpageNum++;\r\n\t\t\t\t\t\tthis.getWinList(pageNum);\r\n\t\t\t\t\t\tconsole.log('到底了',pageNum)\r\n\t\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tonRefresh() {\r\n\t\t\t\t  setTimeout(() => {\r\n\t\t\t\t\t  this.winList=[]\r\n\t\t\t\t\t  pageNum=1;\r\n\t\t\t\t\t  this.getWinList(pageNum);\r\n\t\t\t\t\tthis.$toast('刷新成功');\r\n\t\t\t\t\tthis.isLoading = false;\r\n\t\t\t\t  }, 1000);\r\n\t\t\t\t},\r\n\t\t\t// 获取窗口列表\r\n\t\t\tgetWinList(pageNum){\r\n\t\t\t\tvar _this=this;\r\n\t\t\t\tvar load=_this.$toast.loading({\r\n\t\t\t\t  message: '加载中...',\r\n\t\t\t\t  duration:0,\r\n\t\t\t\t  forbidClick: true,\r\n\t\t\t\t});\r\n\t\t\t  _this.$axios({\r\n\t\t\t\t  method: 'get',\r\n\t\t\t\t  url: port+'/v1/ordermeal/queryWindowByShopId',\r\n\t\t\t\t  params: {\r\n\t\t\t\t    shopId:_this.shopId,\r\n\t\t\t\t\tpageNum:pageNum,\r\n\t\t\t\t\tpageSize:10\r\n\t\t\t\t  }\r\n\t\t\t\t}).then(function(data){\r\n\t\t\t\t\tconsole.log('窗口列表',data);\r\n\r\n\t\t\t\t\tload.clear();//关闭加载\r\n\t\t\t\t\tif (data.data.status==200) {\r\n\t\t\t\t\t\tif (data.data.data.list.length<=0) {\r\n\t\t\t\t\t\t\t_this.$toast('暂无更多信息');\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\tvar arr=data.data.data.list;\r\n\t\t\t\t\t\t\tfor (var i=0;i<arr.length;i++) {\r\n\t\t\t\t\t\t\t\tarr[i].commentScore=Math.round(arr[i].commentScore)//四舍五入评价\r\n\t\t\t\t\t\t\t\tif (arr[i].deliveryMode) {\r\n\t\t\t\t\t\t\t\t\tarr[i].deliveryMode=arr[i].deliveryMode.split(',');//商户状态字符串转为数组\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t// 窗口状态：businessState!=1为营业中，\r\n\t\t\t\t\t\t\t\tif(arr[i].businessState!=1){\r\n\t\t\t\t\t\t\t\t\t// 如果businessState!=1，再判断所有时间段是否都没选，都没选为营业，\r\n\t\t\t\t\t\t\t\t\tif(!arr[i].beginTime1&&!arr[i].endTime1&&!arr[i].beginTime2&&!arr[i].endTime2&&!arr[i].beginTime3&&!arr[i].endTime3){\r\n\t\t\t\t\t\t\t\t\t\tarr[i].businessState=0;\r\n\t\t\t\t\t\t\t\t\t\tarr[i].winState='./static/images/icon/yuding_icon.png'\r\n\t\t\t\t\t\t\t\t\t\tconsole.log(1)\r\n\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\t// 否则判断系统时间是否在设置的时间段内，如果有一个在时间段内，则设置窗口为营业\r\n\t\t\t\t\t\t\t\t\t\tif(isDuringDate(arr[i].beginTime1,arr[i].endTime1)||isDuringDate(arr[i].beginTime2,arr[i].endTime2)||isDuringDate(arr[i].beginTime3,arr[i].endTime3)){\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(2)\r\n\t\t\t\t\t\t\t\t\t\t\tarr[i].businessState=0;\r\n\t\t\t\t\t\t\t\t\t\t\tarr[i].winState='./static/images/icon/yuding_icon.png'\r\n\t\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\t\t// 否则设置窗口营业状态为休息\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(3)\r\n\t\t\t\t\t\t\t\t\t\t\tarr[i].businessState=1;\r\n\t\t\t\t\t\t\t\t\t\t\tarr[i].winState='./static/images/icon/rest_icon.png'\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\talert(4)\r\n\t\t\t\t\t\t\t\t\tarr[i].businessState=1;\r\n\t\t\t\t\t\t\t\t\tarr[i].winState='./static/images/icon/rest_icon.png'\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif (!arr[i].windowPic) {\r\n\t\t\t\t\t\t\t\t\tarr[i].windowPic='./static/images/icon/default1.png';\r\n\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\tarr[i].windowPic=sellerPort+arr[i].windowPic\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t_this.winList.push(arr[i])\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(data.data.status==600){\r\n\t\t\t\t\t\t_this.$toast(data.data.msg);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(data.data.status==601||data.data.status==602||data.data.status==603){\r\n\t\t\t\t\t\t_this.$toast('登录过期，请重新登录');\r\n\t\t\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\t\t\t_this.$router.push({'path':'/login'})\r\n\t\t\t\t\t\t},2000)\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch(function(error){\r\n\t\t\t\t\tconsole.log(error);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\r\n\t\t\t// 跳转到窗口详情（窗口名称、窗口id、商家id、起送、配送、配送类型（外送、自提、到店用餐），窗口营业状态（0可预订其他休息），月销量，星级分数）\r\n\t\t\ttoWinDetail(winName,winId,sellerId,deliveryMinAmount,deliveryFee,deliveryMode,winState,orderCount,starScore){\r\n\t\t\t\tconsole.log(winName,winId,sellerId,deliveryMinAmount,deliveryFee,deliveryMode)\r\n\t\t\t\tthis.$router.push({path:'/winDetail',query:{winName:winName,winId:winId,sellerId:sellerId,deliveryMinAmount:deliveryMinAmount,deliveryFee:deliveryFee?deliveryFee:0,deliveryMode:deliveryMode,winState:winState,orderCount:orderCount,starScore:starScore}});\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t},\r\n\t\tcreated:function(){\r\n\t\t\tpageNum=1;\r\n\t\t\tthis.getWinList(pageNum);\r\n\t\t\t\r\n\t\t}\r\n\t};\r\n</script>\r\n<style type=\"text/css\">\r\n.win-list li{position: relative;background: #fff;padding: 10px;overflow: hidden;margin: 10px;padding-right: 50px;}\r\n.win-list li .win-status{position: absolute;width: 50px;height: 50px;right: 0;top: 0;}\r\n.win-list li .win-img{width: 75px;height: 75px;background: #eee;float: left;margin-right: 10px;}\r\n.win-list li .win-img img{width: 75px;height: 75px;}\r\n.win-list .win-name{font-size: 16px;overflow: hidden;white-space: nowrap;text-overflow: ellipsis;height: 20px;line-height: 20px;}\r\n.win-list .sell-num{font-size: 12px;color: #999;margin: 5px 0;}\r\n.win-list .sell-num span{margin-left: 4px;}\r\n.win-list .sell-num,.win-list .price{font-size: 12px;color: #999;}\r\n.win-list .win-type{font-size: 12px;position: absolute;bottom: 12px;right: 0;}\r\n.win-list .win-type span{padding: 0 4px;margin-right: 2px;}\r\n.win-list .win-type span.zt{background: #FFF5E8;color: #ECB061;}\r\n.win-list .win-type span.ws{background: #F2FFE8;color: #86C669;}\r\n.win-list .win-type span.dd{background: #E8F4FF;color: #69A1C6;}\r\n</style>"]}]}