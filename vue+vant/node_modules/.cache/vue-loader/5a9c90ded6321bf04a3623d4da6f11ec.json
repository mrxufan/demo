{"remainingRequest":"G:\\dingCanMobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\dingCanMobile\\src\\views\\searchGoods.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"G:\\dingCanMobile\\src\\views\\searchGoods.vue","mtime":1592985052575},{"path":"G:\\dingCanMobile\\node_modules\\css-loader\\dist\\cjs.js","mtime":1587344362830},{"path":"G:\\dingCanMobile\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1587344055013},{"path":"G:\\dingCanMobile\\node_modules\\postcss-loader\\src\\index.js","mtime":1587344830790},{"path":"G:\\dingCanMobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1587344699430},{"path":"G:\\dingCanMobile\\node_modules\\vue-loader\\lib\\index.js","mtime":1587344054728}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLndpbi1saXN0IGxpe3Bvc2l0aW9uOiByZWxhdGl2ZTtiYWNrZ3JvdW5kOiAjZmZmO3BhZGRpbmc6IDEwcHg7b3ZlcmZsb3c6IGhpZGRlbjttYXJnaW46IDEwcHg7cGFkZGluZy1yaWdodDogNTBweDt9DQoud2luLWxpc3QgbGkgLndpbi1zdGF0dXN7cG9zaXRpb246IGFic29sdXRlO3dpZHRoOiA1MHB4O2hlaWdodDogNTBweDtyaWdodDogMDt0b3A6IDA7fQ0KLndpbi1saXN0IGxpIC53aW4taW1ne3dpZHRoOiA3NXB4O2hlaWdodDogNzVweDtiYWNrZ3JvdW5kOiAjZWVlO2Zsb2F0OiBsZWZ0O21hcmdpbi1yaWdodDogMTBweDt9DQoud2luLWxpc3QgbGkgLndpbi1pbWcgaW1ne3dpZHRoOiA3NXB4O2hlaWdodDogNzVweDt9DQoud2luLWxpc3QgLndpbi1uYW1le2ZvbnQtc2l6ZTogMTZweDtvdmVyZmxvdzogaGlkZGVuO3doaXRlLXNwYWNlOiBub3dyYXA7dGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7aGVpZ2h0OiAyMHB4O2xpbmUtaGVpZ2h0OiAyMHB4O30NCi53aW4tbGlzdCAuc2VsbC1udW17Zm9udC1zaXplOiAxMnB4O2NvbG9yOiAjOTk5O21hcmdpbjogNXB4IDA7fQ0KLndpbi1saXN0IC5zZWxsLW51bSwud2luLWxpc3QgLnByaWNle2ZvbnQtc2l6ZTogMTJweDtjb2xvcjogIzk5OTt9DQoud2luLWxpc3QgLndpbi10eXBle2ZvbnQtc2l6ZTogMTJweDtwb3NpdGlvbjogYWJzb2x1dGU7Ym90dG9tOiAxMnB4O3JpZ2h0OiAwO30NCi53aW4tbGlzdCAud2luLXR5cGUgc3BhbntwYWRkaW5nOiAwIDRweDttYXJnaW4tcmlnaHQ6IDJweDt9DQoud2luLWxpc3QgLndpbi10eXBlIHNwYW4uenR7YmFja2dyb3VuZDogI0ZGRjVFODtjb2xvcjogI0VDQjA2MTt9DQoud2luLWxpc3QgLndpbi10eXBlIHNwYW4ud3N7YmFja2dyb3VuZDogI0YyRkZFODtjb2xvcjogIzg2QzY2OTt9DQoud2luLWxpc3QgLndpbi10eXBlIHNwYW4uZGR7YmFja2dyb3VuZDogI0U4RjRGRjtjb2xvcjogIzY5QTFDNjt9DQouZy1wcmljZXtjb2xvcjogI0VBNDY0Njtmb250LXNpemU6IDE3cHg7Zm9udC13ZWlnaHQ6IGJvbGQ7fQ0K"},{"version":3,"sources":["searchGoods.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"searchGoods.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n\t<div class=\"win-list\">\r\n\t\t\r\n\t\t<!-- 顶部导航 -->\r\n\t\t<top-fixed-nav title=\"商品\"></top-fixed-nav>\r\n\t\t<van-pull-refresh v-model=\"isLoading\" @refresh=\"onRefresh\">\r\n\t\t\t<!-- 窗口列表 -->\r\n\t\t\t<div class=\"win-list\" style=\"min-height: 300px;\">\r\n\t\t\t\t<ul>\r\n\t\t\t\t\t<li v-for=\"item in winList\" @click=\"toWinDetail(item.winName,item.winId,item.sellerId,item.deliveryMinAmount,item.deliveryFee,item.deliveryMode,item.businessState,item.orderCount,item.commentScore)\">\r\n\t\t\t\t\t\t<div class=\"win-img\"><img :src=\"item.goodsPic\"></div>\r\n\t\t\t\t\t\t<div class=\"win-info\">\r\n\t\t\t\t\t\t\t<p class=\"win-name\">{{item.goodsName}}</p>\r\n\t\t\t\t\t\t\t<p class=\"sell-num\"><span>月售{{item.sellCounter}}单</span></p>\r\n\t\t\t\t\t\t\t<p class=\"price\">\r\n\t\t\t\t\t\t\t\t<span v-show=\"item.deliveryMinAmount\" style=\"margin-right: 5px;\">起送￥{{item.deliveryMinAmount}}</span>\r\n\t\t\t\t\t\t\t\t<span class=\"g-price\">￥{{item.gPrice}}</span>\r\n\t\t\t\t\t\t\t</p>\r\n\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<p class=\"win-type\">\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<span v-bind:class=\"[item1=='1'?'ws':item1=='2'?'zt':'dd']\" v-for=\"item1 in item.deliveryMode\">{{item1=='1'?'外送':item1=='2'?'自提':'到店用餐'}}</span>\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\t\t</van-pull-refresh>\r\n\t\t\r\n\t</div>\r\n</template>\r\n\r\n<script type=\"text/javascript\">\r\n\tvar pageNum=1;//页码\r\n\texport default{\r\n\t\tdata:function(){\r\n\t\t\treturn{\r\n\t\t\t\tsellerId:'',//商家id\r\n\t\t\t\tshopName:'',//标题\r\n\t\t\t\tshopId:this.$route.query.shopId,//店铺传递的店铺id\r\n\t\t\t\tshopName:this.$route.query.shopName,//店铺传递的店铺名称\r\n\t\t\t\twinList:[],//窗口列表\r\n\t\t\t\tstar:3,//评分\r\n\t\t\t\t// winStatus:'./static/images/icon/yuding_icon.png',//图片\r\n\t\t\t\tsellerState:[],//商家状态\r\n\t\t\t\tisLoading:false,//上拉刷新\r\n\t\t\t};\r\n\t\t},\r\n\t\tcomponents:{\r\n\t\t\t\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\t // 滚动到底加载更多\r\n\t\t\twindow.addEventListener('scroll',this.reachBottom)\t\t\t  \r\n\t\t},\r\n\t\t// 销毁监听滚动条事件\r\n\t\tdestroyed(){\r\n\t\t    window.removeEventListener('scroll', this.reachBottom)\r\n\t\t\tconsole.log('销毁')\r\n\t\t  },\r\n\t\tmethods:{\r\n\t\t\t// 滚动到底加载更多\r\n\t\t\treachBottom(){\r\n\t\t\t\t  //变量scrollTop是滚动条滚动时，距离顶部的距离\r\n\t\t\t\t  let scrollTop = document.documentElement.scrollTop||document.body.scrollTop;\r\n\t\t\t\t  //变量windowHeight是可视区的高度\r\n\t\t\t\t  let windowHeight = document.documentElement.clientHeight || document.body.clientHeight;\r\n\t\t\t\t  //变量scrollHeight是滚动条的总高度\r\n\t\t\t\t  let scrollHeight = document.documentElement.scrollHeight||document.body.scrollHeight;\r\n\t\t\t\t\t//滚动条到底部的条件\r\n\t\t\t\t\tif(scrollTop+windowHeight >= scrollHeight){\r\n\t\t\t\t\t\tpageNum++;\r\n\t\t\t\t\t\tthis.getSearchGoods(pageNum);\r\n\t\t\t\t\t\tconsole.log('到底了',pageNum)\r\n\t\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tonRefresh() {\r\n\t\t\t\t  setTimeout(() => {\r\n\t\t\t\t\t  this.winList=[]\r\n\t\t\t\t\t  pageNum=1;\r\n\t\t\t\t\t  this.getSearchGoods(pageNum);\r\n\t\t\t\t\tthis.isLoading = false;\r\n\t\t\t\t  }, 1000);\r\n\t\t\t\t},\r\n\t\t\t// 获取商品列表\r\n\t\t\tgetSearchGoods(pageNum){\r\n\t\t\t\tvar _this=this;\r\n\t\t\t\tvar load=_this.$toast.loading({\r\n\t\t\t\t  message: '加载中...',\r\n\t\t\t\t  duration:0,\r\n\t\t\t\t  forbidClick: true,\r\n\t\t\t\t});\r\n\t\t\t  _this.$axios({\r\n\t\t\t\t  method: 'get',\r\n\t\t\t\t  url: port+'/v1/ordermeal/searchGoods',\r\n\t\t\t\t  params: {\r\n\t\t\t\t\tpageNum:pageNum,\r\n\t\t\t\t\tpageSize:10,\r\n\t\t\t\t\tcId:localStorage.getItem('cId'),\r\n\t\t\t\t\tkeyword:_this.$route.query.searchText,//搜索关键字\r\n\t\t\t\t  }\r\n\t\t\t\t}).then(function(data){\r\n\t\t\t\t\tconsole.log('商品列表',data);\r\n\r\n\t\t\t\t\tload.clear();//关闭加载\r\n\t\t\t\t\tif (data.data.status==200) {\r\n\t\t\t\t\t\tif (data.data.data.list.length<=0) {\r\n\t\t\t\t\t\t\t_this.$toast('暂无更多信息');\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\tvar arr=data.data.data.list;\r\n\t\t\t\t\t\t\tfor (var i=0;i<arr.length;i++) {\r\n\t\t\t\t\t\t\t\tarr[i].commentScore=Math.round(arr[i].commentScore)//四舍五入评价\r\n\t\t\t\t\t\t\t\tif (arr[i].deliveryMode) {\r\n\t\t\t\t\t\t\t\t\tarr[i].deliveryMode=arr[i].deliveryMode.split(',');//商户状态字符串转为数组\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// 窗口状态：businessState!=1为营业中，\r\n\t\t\t\t\t\t\t\tif(arr[i].businessState!=1){\r\n\t\t\t\t\t\t\t\t\t// 如果businessState!=1，再判断所有时间段是否都没选，都没选为营业，\r\n\t\t\t\t\t\t\t\t\tif(!arr[i].beginTime1&&!arr[i].endTime1&&!arr[i].beginTime2&&!arr[i].endTime2&&!arr[i].beginTime3&&!arr[i].endTime3){\r\n\t\t\t\t\t\t\t\t\t\tarr[i].businessState=0;\r\n\t\t\t\t\t\t\t\t\t\tconsole.log(1)\r\n\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\t// 否则判断系统时间是否在设置的时间段内，如果有一个在时间段内，则设置窗口为营业\r\n\t\t\t\t\t\t\t\t\t\tif(isDuringDate(arr[i].beginTime1,arr[i].endTime1)||isDuringDate(arr[i].beginTime2,arr[i].endTime2)||isDuringDate(arr[i].beginTime3,arr[i].endTime3)){\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(2)\r\n\t\t\t\t\t\t\t\t\t\t\tarr[i].businessState=0;\r\n\t\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\t\t// 否则设置窗口营业状态为休息\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(3)\r\n\t\t\t\t\t\t\t\t\t\t\tarr[i].businessState=1;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\tconsole.log(4)\r\n\t\t\t\t\t\t\t\t\tarr[i].businessState=1;\r\n\t\t\t\t\t\t\t\t\tarr[i].winState='./static/images/icon/rest_icon.png'\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif (!arr[i].goodsPic) {\r\n\t\t\t\t\t\t\t\t\tarr[i].goodsPic='./static/images/icon/default1.png';\r\n\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\tarr[i].goodsPic=sellerPort+arr[i].goodsPic\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t_this.winList.push(arr[i])\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(data.data.status==600){\r\n\t\t\t\t\t\t_this.$toast(data.data.msg);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(data.data.status==601||data.data.status==602||data.data.status==603){\r\n\t\t\t\t\t\t_this.$toast('登录过期，请重新登录');\r\n\t\t\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\t\t\t_this.$router.push({'path':'/login'})\r\n\t\t\t\t\t\t},2000)\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch(function(error){\r\n\t\t\t\t\tconsole.log(error);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\r\n\t\t\t// 跳转到窗口详情（窗口名称、窗口id、商家id、起送、配送、配送类型（外送、自提、到店用餐），窗口营业状态（1可预订2休息），月销量，星级分数）\r\n\t\t\ttoWinDetail(winName,winId,sellerId,deliveryMinAmount,deliveryFee,deliveryMode,winState,orderCount,starScore){\r\n\t\t\t\tconsole.log(winName,winId,sellerId,deliveryMinAmount,deliveryFee,deliveryMode)\r\n\t\t\t\tthis.$router.push({path:'/winDetail',query:{winName:winName,winId:winId,sellerId:sellerId,deliveryMinAmount:deliveryMinAmount,deliveryFee:deliveryFee?deliveryFee:0,deliveryMode:deliveryMode,winState:winState,orderCount:orderCount,starScore:starScore}});\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t},\r\n\t\tcreated:function(){\r\n\t\t\tpageNum=1;\r\n\t\t\tthis.getSearchGoods(pageNum);\r\n\t\t}\r\n\t};\r\n</script>\r\n<style type=\"text/css\">\r\n.win-list li{position: relative;background: #fff;padding: 10px;overflow: hidden;margin: 10px;padding-right: 50px;}\r\n.win-list li .win-status{position: absolute;width: 50px;height: 50px;right: 0;top: 0;}\r\n.win-list li .win-img{width: 75px;height: 75px;background: #eee;float: left;margin-right: 10px;}\r\n.win-list li .win-img img{width: 75px;height: 75px;}\r\n.win-list .win-name{font-size: 16px;overflow: hidden;white-space: nowrap;text-overflow: ellipsis;height: 20px;line-height: 20px;}\r\n.win-list .sell-num{font-size: 12px;color: #999;margin: 5px 0;}\r\n.win-list .sell-num,.win-list .price{font-size: 12px;color: #999;}\r\n.win-list .win-type{font-size: 12px;position: absolute;bottom: 12px;right: 0;}\r\n.win-list .win-type span{padding: 0 4px;margin-right: 2px;}\r\n.win-list .win-type span.zt{background: #FFF5E8;color: #ECB061;}\r\n.win-list .win-type span.ws{background: #F2FFE8;color: #86C669;}\r\n.win-list .win-type span.dd{background: #E8F4FF;color: #69A1C6;}\r\n.g-price{color: #EA4646;font-size: 17px;font-weight: bold;}\r\n</style>"]}]}